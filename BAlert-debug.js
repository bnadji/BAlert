/*!
 * BAlert.js - v2.2 - 2018-04
 *
 * Copyright (c) 2018 Behzad Nadji;
 * Licensed under the MIT license
*/
var BAlert=function(t,e,n,i,o){function a(){return{position:{X:"c",Y:"15%",staggerX:"~5px",staggerY:"5px"},size:{X:0,Y:0,calcX:null,calcY:null},title:{},content:{size:{X:0,Y:0,calcX:null,calcY:null}},mainButtons:[],exitButton:{icon:null,raw:null,text:"&times;",inlineStyle:"",threshold:3e3,visible:function(){return 0===$.timeout||$.timeout>$.exitButton.threshold}},animStart:{duration:250,delay:0,dir:"top",scale:0,rotate:0,func:"ease-in"},animExit:{duration:350,delay:0,dir:"none",scale:0,rotate:0,func:"ease-out"},callbacks:{onDisplayBegin:null,onDisplayEnd:null,onExitBegin:null,onExitEnd:null,onResize:function(){L()},onTapOutside:function(t){return function(t){t!==BAlert.alertArray[BAlert.alertArray.length-1]||K||(r(tt,"IS THE LAST ALERT ON THE STACK -- REMOVING"),G())}(t),!1},onTapInside:null},classPrefix:"bajs_",defaultClasses:{apply:!0,values:{containerDiv:"",alertBoxDiv:"border-radius:0.5rem;width:fit-content;max-width:80%;max-height:80%;font:1rem arial;border:1px solid;background-color:#eee;box-shadow:0px 10px 45px -2px rgba(0,0,0,0.75);",titleDiv:"padding:0.1rem .3rem .3rem;text-align:center",titleIcon:"vertical-align:middle;width:1.5rem;height:1.5rem;margin-top:2px",titleText:"vertical-align:middle;margin-left:2px;font-size:1rem;font-weight:bold",contentDiv:"display:flex;clear:both;padding:0.5rem;overflow:auto",contentIcon:"vertical-align:middle; margin-right:0.5rem;width:1rem;height:1rem;",contentText:"vertical-align:middle; display:table-cell;font-size:1rem",exitButton:"float:right;border:0;padding:0;line-height:0.8rem;background:transparent",exitButtonIcon:"width:1rem;height:1rem",exitButtonText:"font-size:1rem;line-height:0.5rem;vertical-align:top",mainButtonsDiv:"clear:both;text-align:center;padding:0.35rem;display:flow-root",mainButtonsIcon:"vertical-align:middle;width:1rem;height:1rem;margin-right:2px",mainButtonsText:"vertical-align:middle;margin:0 2px",mainButtons:"border-radius:0.5rem;padding:2px;margin: 0.1rem 0.2rem;font-size:0.85rem"}},inlineStyles:{containerDiv:"",alertBoxDiv:"",titleDiv:"",titleIcon:"",titleText:"",contentDiv:"",contentIcon:"",contentText:"",exitButton:"",mainButtonsDiv:"",exitButtonIcon:"",exitButtonText:"",mainButtons:"",mainButtonsIcon:"",mainButtonsText:""},iconsPath:"",startingZIndex:1e3,timeout:0,DEBUG:0}}function r(t,e){$.DEBUG&t&&console.log(J+" "+e)}function s(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function l(t){return t===Object(t)}function c(t){return Array.isArray(t)}function u(t){return l(t)&&!s(t)}function d(t){return q[t]&&q.splice(q.indexOf(t),1),document.body.contains(t)?t.parentNode.removeChild(t):null}function f(t,e,n){window.addEventListener?window.addEventListener(t,e,n):window.attachEvent&&window.attachEvent("on"+t,e),r(tt,"WINDOW CALLBACK ADDED: "+t)}function v(t,e){window.removeEventListener?window.removeEventListener(t,e):window.detachEvent&&window.detachEvent("on"+t,e),r(tt,"WINDOW CALLBACK REMOVED: "+t)}function p(t){if(t){r(tt,"SETTING SELF-DESTRUCT TIMER ("+t+"msec)");return setTimeout(function(){G()},t)}return null}function m(t,e){t&&(r(tt,"CALLBACK CALLED: "+e),t(W))}function h(t){return t*parseFloat(getComputedStyle(document.documentElement).fontSize)}function g(t){var e=(t=t||q.alertBoxDiv).getBoundingClientRect();return[e.width,e.height]}function x(t){var e=(t=t||q.alertBoxDiv).getBoundingClientRect();return[e.left,e.top]}function D(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}function E(){return window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight}function B(t,e,n){var i=["","webkit","Moz","MS","ms","o"];for(var o in i)i.hasOwnProperty(o)&&t.style.setProperty(i[o]+e,n)}function T(t,e){t=t||q.alertBoxDiv,r(tt,"OPACITY: "+(e=e||.5)),t.style.opacity=e}function y(t,e){t=t||q.alertBoxDiv,r(tt,"VISIBILITY: "+e),t.style.visibility=e}function b(t,e){t=t||q.alertBoxDiv,void 0===e&&(e=!1),r(tt,"ENABLE: "+e+" "+t.name),t.disabled=e}function A(t,e){if(void 0===e)return t;if(!l(e)||c(e)||function(t){return"function"==typeof t}(e))return t=e;for(var n in e)if(e.hasOwnProperty(n)){if(l(e[n])&&t[n]){t[n]=A(t[n],e[n]);continue}t[n]=e[n]}return t}function I(){var t="/*Begin BAlert default CSS classes*/";for(var e in $.defaultClasses.values)if($.defaultClasses.values.hasOwnProperty(e)){t+="\n.bajs_"+e+" {";var n=$.defaultClasses.values[e].trim().split(";");for(var i in n)n[i]&&(t+="\n  "+n[i].trim()+";");t+="\n}\n"}return t+"/*End BAlert default CSS classes*/\n"}function w(t){function e(t,e,n){var a=t.attributes;if(o+=new Array(e*i).join(" ")+"<",n){for(var r="",s=0,l=a.length;s<l;s++)r+="\n"+new Array((e+1)*i).join(" ")+a[s].nodeName+"= '"+a[s].nodeValue+"'";o+=t.tagName+r}else o+="/"+t.tagName;o+=">\n"}function n(t,i){for(e(t,i,!0),t=t.firstElementChild;t;)n(t,++i),e(t,i--,!1),t=t.nextElementSibling}var i=4,o="";return n(t,0),e(t,0,!1),o}function O(){$.callbacks.onResize&&$.callbacks.onResize(W)}function S(t){q.alertBoxDiv.contains(t.target)?(r(tt,"CLICK INSIDE ALERT DETECTED"),$.callbacks.onTapInside&&$.callbacks.onTapInside(W)):(r(tt,"CLICK OUTSIDE ALERT DETECTED"),$.callbacks.onTapOutside&&$.callbacks.onTapOutside(W))}function C(t){S(t)}function N(){"center"!==$.position.X&&"Center"!==$.position.X&&"C"!==$.position.X||($.position.X="c"),"center"!==$.position.Y&&"Center"!==$.position.Y&&"C"!==$.position.Y||($.position.Y="c"),$.iconsPath.length>0&&"/"!==$.iconsPath.charAt($.iconsPath.length-1)&&($.iconsPath+="/"),$.animStart||($.animStart={duration:0,delay:0}),$.animExit||($.animExit={duration:0,delay:0}),$.exitButton.raw?($.exitButton.icon="",$.exitButton.text=""):$.exitButton.icon?$.exitButton.text="":$.exitButton.text||($.exitButton.text="&times")}function z(t,e,n,i){void 0===i&&(i=""),r(tt,"BUILDING "+e+i+" <"+n+">");var o=t.appendChild(document.createElement(n));return"BUTTON"===n&&(o.name=e+i),"IMG"===n&&(o.alt=""),o.id=e+i+"_"+_,o.className=$.defaultClasses.apply?"def_"+e+"_"+_:$.classPrefix+e,$.inlineStyles[e]&&(o.style.cssText+=";"+$.inlineStyles[e]),o}function k(t,e,n){var i;void 0===n?(i=$[e],n=""):i=$[e][n];var o=z(t,e,"BUTTON",n);return i.raw?o.innerHTML=i.raw:(i.icon&&(q[e+"Icon"+n]=z(o,e+"Icon","IMG",n),q[e+"Icon"+n].src=$.iconsPath+i.icon),i.text&&(q[e+"Text"+n]=z(o,e+"Text","SPAN",n),q[e+"Text"+n].innerHTML=i.text)),i.inlineStyle&&(o.style.cssText+=";"+i.inlineStyle),o.type="button",o.text=i.text,o.index=parseInt(n),o.name=e+n,q[e+n]=o,o.onclick=function(){$.DEBUG&tt&&console.log(J+" BUTTON PRESSED: "+e+", text='"+o.text+"', keepAlert="+(i.keepAlert?"yes":"no")+", selfDim="+(i.selfDim?"yes":"no")+", selfDisable="+(i.selfDisable?"yes":"no")+", selfHide="+(i.selfHide?"yes":"no")+", selfRemove="+(i.selfRemove?"yes":"no")+", onClick="+(i.onClick?"f() is given":"null")),i.selfDim&&T(o),i.selfDisable&&b(o,!0),i.selfHide&&y(o,"hidden"),i.selfRemove&&setTimeout(function(){d(o)},5),i.onClick&&i.onClick(W,o),i.keepAlert||G()},o}function R(){r(it,"DEFAULT CSS CLASSES:\n"+I()+"\n"),r(et,"CONFIGURATION OPTIONS:\n"+JSON.stringify($,null,4)+"\n\n"),r(tt,"DOM BUILD STARTED"),$.defaultClasses.apply&&function(){(Q=document.createElement("style")).type="text/css";var t="";for(var e in $.defaultClasses.values)$.defaultClasses.values.hasOwnProperty(e)&&(t+=".def_"+e+"_"+_+"{"+$.defaultClasses.values[e]+"}\n");Q.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(Q),r(tt,"BUILDING DEFAULT DOM <style>")}(),function(){var t=document.getElementsByTagName("body")[0];q.containerDiv=z(t,"containerDiv","DIV"),q.containerDiv.style.height=E()+"px",q.containerDiv.style.zIndex=$.startingZIndex+j,q.containerDiv.style.position="absolute"}(),q.alertBoxDiv=z(q.containerDiv,"alertBoxDiv","DIV"),q.alertBoxDiv.style.position="fixed",$.exitButton.visible="function"==typeof $.exitButton.visible?$.exitButton.visible(W):$.exitButton.visible,($.title.text||$.title.icon||$.title.raw||$.exitButton.visible)&&(q.titleDiv=z(q.alertBoxDiv,"titleDiv","DIV"),$.title.raw?q.titleDiv.innerHTML=$.title.raw:($.title.icon&&(q.titleIcon=z(q.titleDiv,"titleIcon","IMG"),q.titleIcon.src=$.iconsPath+$.title.icon),$.title.text&&(q.titleText=z(q.titleDiv,"titleText","SPAN"),q.titleText.innerHTML=$.title.text)),$.exitButton.visible&&(q.exitButton=k(q.titleDiv,"exitButton"))),($.content.text||$.content.raw||$.content.icon)&&(q.contentDiv=z(q.alertBoxDiv,"contentDiv","DIV"),$.content.raw?q.contentDiv.innerHTML=$.content.raw:($.content.icon&&(q.contentIcon=z(q.contentDiv,"contentIcon","IMG"),q.contentIcon.src=$.iconsPath+$.content.icon),$.content.text&&(q.contentText=z(q.contentDiv,"contentText","SPAN"),q.contentText.innerHTML=$.content.text))),function(){if(q.mainButtons=[],!s($.mainButtons)){q.mainButtonsDiv=z(q.alertBoxDiv,"mainButtonsDiv","DIV");for(var t in $.mainButtons)$.mainButtons.hasOwnProperty(t)&&q.mainButtons.push(k(q.mainButtonsDiv,"mainButtons",t))}}(),r(tt,"DOM BUILD DONE"),r(nt,"BROWSER DOM STRUCTURE:\n"+w(q.containerDiv)+"\n\n"),r(ot,"INTERNAL DOM OBJECT STRUCTURE:\n"+JSON.stringify(q,null,4)+"\n\n"),y(q.alertBoxDiv,"hidden"),function(){u($.content.size)&&($.content.size.X&&($.content.size.calcX=Y({raw:$.content.size.X,dir:"h",negOpposite:!1})),$.content.size.Y&&($.content.size.calcY=Y({raw:$.content.size.Y,dir:"v",negOpposite:!1})));$.content.size.calcX&&(q.contentDiv.style.width=$.content.size.calcX.val+$.content.size.calcX.unit);$.content.size.calcY&&(q.contentDiv.style.height=$.content.size.calcY.val+$.content.size.calcY.unit);u($.size)&&($.size.X&&($.size.calcX=Y({raw:$.size.X,dir:"h",negOpposite:!1})),$.size.Y&&($.size.calcY=Y({raw:$.size.Y,dir:"v",negOpposite:!1})));$.size.calcX&&(q.alertBoxDiv.style.width=$.size.calcX.val+$.size.calcX.unit);$.size.calcY&&(q.alertBoxDiv.style.height=$.size.calcY.val+$.size.calcY.unit)}(),L()}function L(t,e){void 0!==t&&(2===arguments.length?($.position.X=t,$.position.Y=e):c(t)&&($.position.X=t[0],$.position.Y=t[1]),r(tt,"REQUEST MOVE TO: ["+$.position.X+","+$.position.Y+"]")),function(){$.position.calcX=Y({raw:$.position.X,dir:"h",negOpposite:!0}),$.position.calcY=Y({raw:$.position.Y,dir:"v",negOpposite:!0});var t=function(){var t=BAlert.alertArray,e=t.indexOf(W),n=1,i=1,o=W.getConf("position").X,a=W.getConf("position").Y;for(;t[e-n];)o===t[e-n].getConf("position").X&&a===t[e-n].getConf("position").Y&&i++,n+=1;return i}();$.position.calcX.val+=M({raw:$.position.staggerX,dir:"h",negOpposite:!1,size:t}).val,$.position.calcY.val+=M({raw:$.position.staggerY,dir:"v",negOpposite:!1,size:t}).val,q.alertBoxDiv.style.left=$.position.calcX.val+$.position.calcX.unit,q.alertBoxDiv.style.top=$.position.calcY.val+$.position.calcY.unit}(),r(tt,"MOVED TO: ["+$.position.calcX.val+","+$.position.calcY.val+"]")}function X(t){var e="h"===t.dir?D():E();return(t=function(t){if(t.alt=!1,t.isPerc=!1,t.isNeg=!1,t.sign=1,t.unit="px","string"==typeof t.raw&&(t.raw=t.raw.trim()),t.centered=function(t){return 0!==t&&!t}(t.raw)||"c"===t.raw,!t.centered){t.alt="string"==typeof t.raw&&"~"===t.raw.charAt(0),t.alt&&(t.raw=t.raw.substring(1)),t.isPerc="string"==typeof t.raw&&"%"===t.raw.slice(-1),t.isPerc&&(t.raw=t.raw.slice(0,-1)),t.isNeg="string"==typeof t.raw&&"-"===t.raw.slice(0,1)||"number"==typeof t.raw&&t.raw<0,t.sign=t.isNeg?-1:1,t.absVal=Math.abs(parseFloat(t.raw))||0;var e="string"==typeof t.raw?/(\d+\.*\d*)(\D+$)/g.exec(t.raw):null;t.unit=e&&e.length>0?e[e.length-1]:"px"}return t}(t)).centered?t.val=e/2:(t.isPerc&&(t.absVal=t.absVal*e/100),t.isNeg&&t.negOpposite?t.val=e-t.absVal:t.val=t.absVal,t.negOpposite||(t.val*=t.sign),"rem"===t.unit&&(t.val=h(t.val)),t.unit="px"),t}function Y(t){var e=g(),n="h"===t.dir?e[0]:e[1];return(t=X(t)).centered?t.val=t.val-n/2:t.isNeg&&t.negOpposite&&(t.val=t.val-n),t}function M(t){return 1===(t=X(t)).size?t.val=0:t.alt?t.val=t.size%2==0?t.absVal:-t.absVal:t.val=(t.size-1)*t.absVal,t.val=t.val*t.sign,"rem"===t.unit&&(t.val=h(t.val)),t.unit="px",t}function P(t){var e,n,i=0,o=0,a=D(),s=E(),l=x(),u=l[0],d=l[1],f=g(),v=f[0],p=f[1],m=t.scale,h=u+v/2,B=d+p/2;if(c(t.dir))e=X({raw:t.dir[0],dir:"h",negOpposite:!0}).val,n=X({raw:t.dir[1],dir:"v",negOpposite:!0}).val;else switch(t.dir){case"left":e=-v*m/2,n=d+p/2;break;case"top":e=u+v/2,n=-p*m/2;break;case"right":e=a+v*m/2,n=d+p/2;break;case"bottom":e=u+v/2,n=s+p*m/2;break;case"top left":case"left top":e=-v*m/2,n=-p*m/2;break;case"top right":case"right top":e=a+v*m/2,n=-p*m/2;break;case"bottom left":case"left bottom":e=-v*m/2,n=s+p*m/2;break;case"bottom right":case"right bottom":e=a+v*m/2,n=s+p*m/2;break;case"left center":case"center left":e=-v*m/2,n=s/2;break;case"right center":case"center right":e=a+v*m/2,n=s/2;break;case"top center":case"center top":e=a/2,n=-p*m/2;break;case"bottom center":case"center bottom":e=a/2,n=s+p*m/2;break;case"center":case"center center":e=a/2,n=s/2;break;default:e=u+v/2,n=d+p/2}return i=e-h,o=n-B,r(tt,"CALCULATED HIDING CENTER POSITION delta: ["+i+","+o+"]"),[i,o]}function U(t){return"all "+t.duration/1e3+"s "+t.func}function F(t,e){var n=U(t),i=function(t,e){return"translate("+e[0]+"px,"+e[1]+"px) scale("+t.scale+") "+(t.rotate?"rotate("+360*t.rotate+"deg)":"")}(t,e);r(tt,"ANIM TRANSLATION: "+JSON.stringify(e)),r(tt,"ANIM TRANSITION: "+n),r(tt,"ANIM TRANSFORM: "+i),B(q.alertBoxDiv,"transform-origin","center"),B(q.alertBoxDiv,"transition",n),B(q.alertBoxDiv,"transform",i)}function V(){var t=0;if(m($.callbacks.onDisplayBegin,"onDisplayBegin"),$.animStart.duration){r(tt,"BEGIN OF HIDE ANIMATE"),r(tt,"CURRENT pos:"+JSON.stringify(x())),r(tt,"CURRENT size:"+JSON.stringify(g()));var e=A({},$.animStart);e.rotate&&(e.rotate=-$.animStart.rotate),e.duration=0;var n=P(e);F(e,n),t=5,setTimeout(function(){r(tt,"ANIMATE TO EXISTANCE ("+$.animStart.duration/1e3+"sec)"),y(q.alertBoxDiv,"visible");var e=U($.animStart);B(q.alertBoxDiv,"transition",e),B(q.alertBoxDiv,"transform-origin","center"),B(q.alertBoxDiv,"transform",""),t+=$.animStart.duration,setTimeout(function(){r(tt,"END OF START ANIMATE"),B(q.alertBoxDiv,"transition",""),Z=p($.timeout),m($.callbacks.onDisplayEnd,"onDisplayEnd")},t)},t)}else y(q.alertBoxDiv,"visible"),Z=p($.timeout),m($.callbacks.onDisplayEnd,"onDisplayEnd");$.callbacks.onResize&&f("resize",O),setTimeout(function(){($.callbacks.onTapOutside||$.callbacks.onTapInside)&&(f("touchstart",C,{passive:!1}),f("click",S))},5)}function G(t){(t=t||$.animExit.delay||0)>0?($.DEBUG&tt&&console.log(" DELAYED EXIT REQUESTED, delay(ms)="+t),setTimeout(function(){H()},t)):H()}function H(){K=!0,Z&&(clearTimeout(Z),Z=null),r(tt,"BEGIN OF EXIT PROCESS"),m($.callbacks.onExitBegin,"onExitBegin");var t=0;if($.animExit.duration){r(tt,"BEGIN OF EXIT ANIMATE ("+$.animExit.duration/1e3+"sec)");var e=P($.animExit);F($.animExit,e),t=$.animExit.duration}setTimeout(function(){$.animExit.duration&&r(tt,"END OF EXIT ANIMATE"),$.callbacks.onResize&&v("resize",O),($.callbacks.onTapOutside||$.callbacks.onTapInside)&&v("click",S),($.callbacks.onTapOutside||$.callbacks.onTapInside)&&v("touchstart",C);var t=BAlert.alertArray.indexOf(W);-1!==t&&BAlert.alertArray.splice(t,1),m($.callbacks.onExitEnd,"onExitEnd"),Q&&(r(tt,"DEFAULT DOM <style> REMOVED"),Q.parentNode&&Q.parentNode.removeChild(Q)),r(tt,"END OF EXIT"),d(q.containerDiv),r(tt,"DESTROYED"),K=!1},t)}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var W=this;BAlert.alertArray=BAlert.alertArray||[];var j=s(BAlert.alertArray)?1:BAlert.alertArray.slice(-1).pop().alertNum()+1;BAlert.alertArray.push(W);var _="A"+j,J="ALERT "+j,K=!1,Q=null,Z=null,$=a(),q={};u(t)?$.content=A($.content,t):t&&($.content.raw=t),"number"==typeof e&&($.timeout=e),u(n)?$.title=A($.title,n):n&&($.title.raw=n),!c(i)&&u(i)&&(i=[i]),$.mainButtons=A($.mainButtons,i),$=A($,o);var tt=1,et=2,nt=4,it=8,ot=16;this.getConf=function(t){return t?$[t]:$},this.setConf=function(t,e){return 1===arguments.length?$=A($,t):$[t]=A($[t],e),this},this.noDefaultClasses=function(){return $.defaultClasses.apply=!1,this},this.getDefaultClasses=function(){return I()},this.setDefaultClasses=function(t,e){return 1===arguments.length?$.defaultClasses.values=e:$.defaultClasses.values[t]=e,this},this.setDebug=function(t){return t=t||0,$.DEBUG=t,this},this.setIconsPath=function(t){return $.iconsPath=t,this},this.build=function(){return N(),R(),this},this.display=function(t){return N(),function(t){t=t||$.animStart.delay||0,s(q)&&R(),t?(r(tt,"DELAYED START REQUESTED, delay(ms)="+t),setTimeout(function(){V()},t)):V()}(t),this},this.exit=function(t){return G(t),this},this.move=function(t,e){return L(t,e),this},this.enable=function(t){return b(t,!1),this},this.disable=function(t){return b(t,!0),this},this.hide=function(t){return y(t,"hidden"),this},this.unhide=function(t){return y(t,"visible"),this},this.dim=function(t,e){return T(t,e),this},this.undim=function(t){return T(t,1),this},this.remove=function(t){return d(t),this},this.getPosition=function(){return x()},this.getCenterPosition=function(t){return function(t){var e=(t=t||q.alertBoxDiv).getBoundingClientRect();return[e.left+e.width/2,e.top+e.height/2]}(t)},this.getSize=function(){return g()},this.getStructure=function(t){return t=t||q.containerDiv,w(t)},this.getElement=function(t){return t=t||"alertBoxDiv",q[t]},this.merge=function(t,e){return A(t,e)},this.setCrossBrowserStyle=function(t,e,n){return B(t,e,n),this},this.reset=function(){return $=a(),q={},this},this.version=function(){return"2.6"},this.alertNum=function(){return j},this.conf=$,this.DOM=q};